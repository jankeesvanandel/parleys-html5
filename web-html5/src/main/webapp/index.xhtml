<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
        template="WEB-INF/facelets/template.xhtml"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:p="http://www.parleys.com/jsf/taglib"
        xmlns:parleys="http://java.sun.com/jsf/composite/parleys">
    <ui:param name="parleysBean" value="#{homepageBean}"/>
    <ui:define name="header">
        <f:metadata>
            <f:viewParam name="filter" value="#{homepageBean.thumbnailsFilter}"/>
            <f:viewParam name="filterType" value="#{homepageBean.thumbnailsFilterType}"/>
            <f:viewParam name="newsId" value="#{homepageBean.newsId}"/>
            <f:event type="preRenderView" listener="#{homepageBean.init}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="content">
        <div>
            <h2>Overview</h2>
            <ul id="featureHomepage">
                <li>
                    <h:link outcome="presentations">
                        <f:param name="filter" value="FEATURED"/>
                        Featured
                    </h:link> |
                </li>
                <li>
                    <h:link outcome="presentations">
                        <f:param name="filter" value="LATEST"/>
                        Latest
                    </h:link> |
                </li>
                <li>
                    <h:link outcome="presentations">
                        <f:param name="filter" value="TOP_RATED"/>
                        Top Rated
                    </h:link> |
                </li>
                <li>
                    <h:link outcome="presentations">
                        <f:param name="filter" value="MOST_VIEWED"/>
                        Most Viewed
                    </h:link> |
                </li>
                <li>
                    <h:link outcome="spaces">
                        <f:param name="filter" value="FEATURED"/>
                        Featured Spaces
                    </h:link> |
                </li>
                <li>
                    <h:link outcome="channels">
                        <f:param name="filter" value="FEATURED"/>
                        Featured Channels
                    </h:link> |
                </li>
            </ul>
        </div>
        <hr class="clear" style="display:none"/>
        <br/>

        <div id="thumbnails">
            <ui:repeat value="#{homepageBean.thumbnails}" var="presentation">
                <div class="thumbnail">
                    <h3 title="#{presentation.title}">#{p:shortenTo(17, presentation.title)}</h3>
                    <h:link outcome="presentation">
                        <f:param name="id" value="#{presentation.id}"/>
                        <h:graphicImage value="#{p:presentationThumbnail(presentation.id, presentation.thumbnailURL)}"
                                        alt=""
                                        width="133"
                                        height="88"/>
                    </h:link>
                </div>
            </ui:repeat>
        </div>
        <hr class="clear" style="display:none"/>

        <div id="frontpage">
            <div class="twoCol">
                <div class="col">
                    <h2>General News</h2>

                    <div class="contentBlock news">
                        <h3>#{homepageBean.newsItems[homepageBean.activeNewsItemIndex].title}</h3>
                        <span class="newsDate">#{p:formatDate(homepageBean.newsItems[homepageBean.activeNewsItemIndex].createdOn)}</span>

                        <p>
                            <h:outputText escape="false"
                                          value="#{homepageBean.newsItems[homepageBean.activeNewsItemIndex].item}"/>
                        </p>
                        <h:link outcome="index"
                                rendered="#{homepageBean.activeNewsItemIndex lt p:sizeOf(homepageBean.newsItems)-1}"
                                styleClass="pagingNext floatRight" title="Next news item">
                            <f:param name="newsId"
                                     value="#{homepageBean.newsItems[homepageBean.activeNewsItemIndex+1].id}"/>
                        </h:link>
                        <span class="floatRight">#{homepageBean.activeNewsItemIndex+1} / #{p:sizeOf(homepageBean.newsItems)}</span>
                        <h:link outcome="index"
                                rendered="#{homepageBean.activeNewsItemIndex != 0}"
                                styleClass="pagingPrev floatRight"
                                title="Previous news item">
                            <f:param name="newsId"
                                     value="#{homepageBean.newsItems[homepageBean.activeNewsItemIndex-1].id}"/>
                        </h:link>                        
                        <br class="clear"/>
                    </div>
                </div>
            </div>
            <div class="twoCol">
                <div class="col">
                    <h2>Featured</h2>

                    <div class="contentBlock">
                        <p>
                            <parleys:spaceLink space="#{homepageBean.recommendedSpace}"
                                                  renderThumbnail="true"
                                                  renderLabel="true"
                                                  renderDescription="true"
                                                  styleClasses="breathe floatLeft"/>
                        </p>
                        <br class="clear"/>
                    </div>
                    <div class="contentBlock">
                        <p>
                            <parleys:channelLink channel="#{homepageBean.recommendedChannel}"
                                                    renderThumbnail="true"
                                                    renderLabel="true"
                                                    renderDescription="true"
                                                    styleClasses="breathe floatRight"/>
                        </p>
                        <br class="clear"/>
                    </div>
                    <div class="contentBlock">
                        <p>
                            <parleys:presentationLink presentation="#{homepageBean.recommendedPresentation}"
                                                         renderThumbnail="true"
                                                         renderLabel="true"
                                                         renderDescription="true"
                                                         styleClasses="breathe floatLeft"/>
                        </p>
                        <br class="clear"/>
                    </div>
                </div>
            </div>
        </div>

        <div id="pods">
            <div class="threeCol">
                <div class="col">
                    <div class="contentBlock">
                        POD1
                    </div>
                </div>
            </div>
            <div class="threeCol">
                <div class="col">
                    <div class="contentBlock">
                        POD2
                    </div>
                </div>
            </div>
            <div class="threeCol">
                <div class="col">
                    <div class="contentBlock">
                        POD3
                    </div>
                </div>
            </div>
        </div>
        <br class="clear"/>
    </ui:define>
</ui:composition>
