<?xml version="1.0" encoding="UTF-8"?>
<ui:composition
      template="WEB-INF/facelets/template.xhtml"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://www.parleys.com/jsf/taglib">
    <ui:define name="header">
        <f:metadata>
            <f:viewParam name="filter" value="#{homepageBean.thumbnailsFilter}"/>
            <f:viewParam name="filterType" value="#{homepageBean.thumbnailsFilterType}"/>
            <f:viewParam name="newsId" value="#{homepageBean.newsId}"/>
            <f:event type="preRenderView" listener="#{homepageBean.init}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="content">
                <div>
                    <h2>Overview</h2>
                    <ul id="featureHomepage">
                        <li>
                            <h:link outcome="presentations">
                                <f:param name="filter" value="FEATURED"/>
                                <f:param name="filterType" value="PRESENTATION"/>
                                Featured
                            </h:link> |
                        </li>
                        <li>
                            <h:link outcome="presentations">
                                <f:param name="filter" value="LATEST"/>
                                <f:param name="filterType" value="PRESENTATION"/>
                                Latest
                            </h:link> |
                        </li>
                        <li>
                            <h:link outcome="presentations">
                                <f:param name="filter" value="TOP_RATED"/>
                                <f:param name="filterType" value="PRESENTATION"/>
                                Top Rated
                            </h:link> |
                        </li>
                        <li>
                            <h:link outcome="presentations">
                                <f:param name="filter" value="MOST_VIEWED"/>
                                <f:param name="filterType" value="PRESENTATION"/>
                                Most Viewed
                            </h:link> |
                        </li>
                        <li>
                            <h:link outcome="spaces">
                                <f:param name="filter" value="FEATURED"/>
                                <f:param name="filterType" value="SPACE"/>
                                Featured Spaces
                            </h:link> |
                        </li>
                        <li>
                            <h:link outcome="channels">
                                <f:param name="filter" value="FEATURED"/>
                                <f:param name="filterType" value="CHANNEL"/>
                                Featured Channels
                            </h:link> |
                        </li>
                    </ul>
                </div>
                <hr class="clear" style="display:none"/>
                <br/>

                <div id="thumbnails">
                    <ui:repeat value="#{homepageBean.thumbnails}" var="presentation">
                        <div class="thumbnail">
                            <h3 title="#{presentation.title}">#{p:shortenTo(17, presentation.title)}</h3>
                            <h:graphicImage value="#{p:presentationThumbnail(presentation.id, presentation.thumbnail)}" alt=""
                                            width="115"
                                            height="85"/>
                        </div>
                    </ui:repeat>
                </div>
                <hr class="clear" style="display:none"/>

                <div id="frontpage">
                    <div class="twoCol">
                        <div class="col">
                            <h2>General News</h2>

                            <div class="contentBlock">
                                <h3>#{homepageBean.newsItems[homepageBean.activeNewsItemIndex].title}</h3>
                                <span class="newsDate">#{p:formatDate(homepageBean.newsItems[homepageBean.activeNewsItemIndex].date)}</span>
                                <p>
                                    <h:outputText escape="false"
                                                  value="#{homepageBean.newsItems[homepageBean.activeNewsItemIndex].content}"/>
                                </p>
                                <h:link outcome="index" rendered="#{homepageBean.activeNewsItemIndex != 0}" styleClass="pagingPrev floatLeft" title="Previous news item">
                                    <f:param name="newsId" value="#{homepageBean.newsItems[homepageBean.activeNewsItemIndex-1].id}" />
                                </h:link>
                                <span class="floatLeft">#{homepageBean.activeNewsItemIndex+1} / #{p:sizeOf(homepageBean.newsItems)}</span>
                                <h:link outcome="index" rendered="#{homepageBean.activeNewsItemIndex lt p:sizeOf(homepageBean.newsItems)-1}" styleClass="pagingNext floatLeft" title="Next news item">
                                    <f:param name="newsId" value="#{homepageBean.newsItems[homepageBean.activeNewsItemIndex+1].id}" />
                                </h:link>
                                <br class="clear" />
                            </div>
                        </div>
                    </div>
                    <div class="twoCol">
                        <div class="col">
                            <h2>Highlights</h2>
                            <div class="contentBlock">
                                <h3>Recommended space: #{homepageBean.recommendedSpace.name}</h3>
                                <p>
                                    <img class="floatLeft breathe" src="#{p:spaceThumbnail(homepageBean.recommendedSpace.id, homepageBean.recommendedSpace.thumbnail)}" alt="" height="50px" width="50px"/>
                                    <h:outputText escape="false" value="#{homepageBean.recommendedSpace.description}" />
                                </p>
                                <br class="clear"/>
                            </div>
                            <div class="contentBlock">
                                <h3>Recommended channel: #{homepageBean.recommendedChannel.name}</h3>
                                <p>
                                    <img class="floatRight breathe" src="#{p:channelThumbnail(homepageBean.recommendedChannel.id, homepageBean.recommendedChannel.thumbnail)}" alt="" height="50px" width="50px"/>
                                    <h:outputText escape="false" value="#{homepageBean.recommendedChannel.description}" />
                                </p>
                                <br class="clear"/>
                            </div>
                            <div class="contentBlock">
                                <h3>Recommended presentation: Solr Power with Lucene</h3>
                                <p>
                                    <img class="floatLeft breathe" src="#{p:presentationThumbnail(homepageBean.recommendedPresentation.id, homepageBean.recommendedPresentation.thumbnail)}" alt="" height="50px" width="50px"/>
                                    <h:outputText escape="false" value="#{homepageBean.recommendedPresentation.summary}" />
                                </p>
                                <br class="clear"/>
                            </div>
                        </div>
                    </div>
                </div>
                <br class="clear"/>
    </ui:define>
</ui:composition>
